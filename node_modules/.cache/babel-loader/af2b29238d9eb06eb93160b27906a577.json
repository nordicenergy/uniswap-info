{"ast":null,"code":"import _regeneratorRuntime from\"/workspace/uniswap-info/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/workspace/uniswap-info/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/workspace/uniswap-info/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"/workspace/uniswap-info/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";function _templateObject10(){var data=_taggedTemplateLiteral([\"\\n  text-decoration: none;\\n\\n  &:visited {\\n    color: rgb(47, 128, 237);\\n  }\\n\"]);_templateObject10=function _templateObject10(){return data;};return data;}function _templateObject9(){var data=_taggedTemplateLiteral([\"\\n  width: 30px;\\n  display: flex;\\n  justify-content: center;\\n  align-items: center;\\n  margin-right: 4px;\\n\\n  @media screen and (max-width: 40em) {\\n    margin-right: 6px;\\n  }\\n\"]);_templateObject9=function _templateObject9(){return data;};return data;}function _templateObject8(){var data=_taggedTemplateLiteral([\"\\n  @media screen and (max-width: 40em) {\\n    font-size: 14px;\\n  }\\n\\n  align-items: center;\\n  text-align: right;\\n\\n  & > * {\\n    font-size: 1em;\\n  }\\n\"]);_templateObject8=function _templateObject8(){return data;};return data;}function _templateObject7(){var data=_taggedTemplateLiteral([\"\\n  text-align: right;\\n\\n  &:hover {\\n    cursor: pointer;\\n    opacity: 0.6;\\n  }\\n\\n  user-select: none;\\n\"]);_templateObject7=function _templateObject7(){return data;};return data;}function _templateObject6(){var data=_taggedTemplateLiteral([\"\\n  @media screen and (max-width: 40em) {\\n    padding: 0 0.4em;\\n  }\\n\"]);_templateObject6=function _templateObject6(){return data;};return data;}function _templateObject5(){var data=_taggedTemplateLiteral([\"\\n  :hover {\\n    // background-color: #f8f8f8;\\n    // cursor: pointer;\\n  }\\n\"]);_templateObject5=function _templateObject5(){return data;};return data;}function _templateObject4(){var data=_taggedTemplateLiteral([\"\\n  display: grid;\\n  grid-gap: 1em;\\n  grid-template-columns: 1fr 1fr 1fr;\\n  grid-template-areas: 'symbol liquidity volume';\\n  padding: 0 6px;\\n\\n  > * {\\n    justify-content: flex-end;\\n    width: 100%;\\n\\n    &:first-child {\\n      justify-content: flex-start;\\n      width: 100px;\\n    }\\n  }\\n\\n  @media screen and (min-width: 40em) {\\n    max-width: 1280px;\\n    display: grid;\\n    grid-gap: 1em;\\n    grid-template-columns: 0.8fr 1fr 1fr 1fr;\\n    grid-template-areas: 'name txs liquidity volume';\\n\\n    > * {\\n      justify-content: flex-end;\\n      width: 100%;\\n\\n      &:first-child {\\n        justify-content: flex-start;\\n        width: 240px;\\n      }\\n    }\\n  }\\n\\n  @media screen and (min-width: 64em) {\\n    max-width: 1280px;\\n    display: grid;\\n    padding: 0 24px;\\n    grid-gap: 1em;\\n    grid-template-columns: 1fr 0.8fr 0.8fr 1fr 1fr 1fr;\\n    grid-template-areas: 'name symbol price volume liquidity txs';\\n  }\\n\"]);_templateObject4=function _templateObject4(){return data;};return data;}function _templateObject3(){var data=_taggedTemplateLiteral([\"\\n  -webkit-overflow-scrolling: touch;\\n\"]);_templateObject3=function _templateObject3(){return data;};return data;}function _templateObject2(){var data=_taggedTemplateLiteral([\"\\n  color: #2f80ed;\\n  opacity: \",\";\\n  padding: 0 20px;\\n  user-select: none;\\n\\n  :hover {\\n    cursor: pointer;\\n  }\\n\"]);_templateObject2=function _templateObject2(){return data;};return data;}function _templateObject(){var data=_taggedTemplateLiteral([\"\\n  width: 100%;\\n  display: flex;\\n  justify-content: center;\\n  margin-top: 2em;\\n  margin-bottom: 2em;\\n\"]);_templateObject=function _templateObject(){return data;};return data;}import React,{useState,useEffect}from'react';import{Link}from'react-router-dom';import{useMedia}from'react-use';import dayjs from'dayjs';import utc from'dayjs/plugin/utc';import{client}from'../../apollo/client';import{OVERVIEW_PAGE_QUERY,TICKER_24HOUR_QUERY}from'../../apollo/queries';import{Box,Flex,Text}from'rebass';import styled from'styled-components';import TokenLogo from'../TokenLogo';import{formattedNum}from'../../helpers';import{Divider}from'../../components';import Loader from'../../components/Loader';dayjs.extend(utc);var PageButtons=styled.div(_templateObject());var Arrow=styled.div(_templateObject2(),function(props){return props.faded?0.3:1;});var List=styled(Box)(_templateObject3());var DashGrid=styled.div(_templateObject4());var DashGridClickable=styled(DashGrid)(_templateObject5());var ListWrapper=styled.div(_templateObject6());var ClickableText=styled(Text)(_templateObject7());var DataText=styled(Flex)(_templateObject8());var LogoBox=styled.div(_templateObject9());var CustomLink=styled(Link)(_templateObject10());// @TODO rework into virtualized list\nfunction OverviewList(_ref){var currencyUnit=_ref.currencyUnit;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),exchanges=_useState2[0],setExchanges=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),filteredTxs=_useState4[0],SetFilteredTxs=_useState4[1];var _useState5=useState({}),_useState6=_slicedToArray(_useState5,2),exchangeData24Hour=_useState6[0],setExchangeData24Hour=_useState6[1];var _useState7=useState(1),_useState8=_slicedToArray(_useState7,2),page=_useState8[0],setPage=_useState8[1];var _useState9=useState(1),_useState10=_slicedToArray(_useState9,2),maxPage=_useState10[0],setMaxPage=_useState10[1];var TXS_PER_PAGE=10;var _useState11=useState(true),_useState12=_slicedToArray(_useState11,2),loading=_useState12[0],setLoading=_useState12[1];var _useState13=useState(true),_useState14=_slicedToArray(_useState13,2),sortDirection=_useState14[0],setSortDirection=_useState14[1];var SORT_FIELD={PRICE:'priceUSD',LIQUIDITY:'ethBalance',TRANSACTIIONS:'txs',VOLUME:'volume',SYMBOL:'tokenSymbol',PRICE_CHANGE:'priceChange',PRICE_CHANGE_ETH:'priceChangeETH'};var _useState15=useState(SORT_FIELD.LIQUIDITY),_useState16=_slicedToArray(_useState15,2),sortedColumn=_useState16[0],setSortedColumn=_useState16[1];function getPercentChangeColor(change){if(change===0){return React.createElement(\"span\",null,change+' %');}if(change<0){return React.createElement(\"span\",{style:{color:'red'}},change+' %');}return React.createElement(\"span\",{style:{color:'green'}},change+' %');}function sortTxs(field){if(field===SORT_FIELD.VOLUME||field===SORT_FIELD.TRANSACTIIONS||field===SORT_FIELD.PRICE_CHANGE||field===SORT_FIELD.PRICE_CHANGE_ETH){var newTxs=filteredTxs.slice().sort(function(a,b){if(!exchangeData24Hour.hasOwnProperty(a.id)){exchangeData24Hour[a.id]={};exchangeData24Hour[a.id].volume=0;exchangeData24Hour[a.id].txs=0;exchangeData24Hour[a.id].priceChange=0;exchangeData24Hour[a.id].priceChangeETH=0;setExchangeData24Hour(exchangeData24Hour);}if(!exchangeData24Hour.hasOwnProperty(b.id)){exchangeData24Hour[b.id]={};exchangeData24Hour[b.id].volume=0;exchangeData24Hour[a.id].txs=0;exchangeData24Hour[b.id].priceChange=0;exchangeData24Hour[a.id].priceChangeETH=0;setExchangeData24Hour(exchangeData24Hour);}return parseFloat(exchangeData24Hour[a.id][field])>parseFloat(exchangeData24Hour[b.id][field])?(sortDirection?-1:1)*1:(sortDirection?-1:1)*-1;});SetFilteredTxs(newTxs);setPage(1);}else{var _newTxs;if(field===SORT_FIELD.SYMBOL){_newTxs=filteredTxs.slice().sort(function(a,b){return a[field].toString().toLowerCase()>b[field].toString().toLowerCase()?(sortDirection?-1:1)*-1:(sortDirection?-1:1)*1;});}else{_newTxs=filteredTxs.slice().sort(function(a,b){return parseFloat(a[field])>parseFloat(b[field])?(sortDirection?-1:1)*-1:(sortDirection?-1:1)*1;});}SetFilteredTxs(_newTxs);setPage(1);}}useEffect(function(){setSortDirection(true);},[exchanges]);// get top 100 exchanges by liquidity\nuseEffect(function(){setPage(1);function getTxs(){return _getTxs.apply(this,arguments);}function _getTxs(){_getTxs=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var gettingExchanges,newExchanges,skip,result;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setLoading(true);gettingExchanges=true;newExchanges=[];skip=0;case 4:if(!gettingExchanges){_context.next=11;break;}_context.next=7;return client.query({query:OVERVIEW_PAGE_QUERY,variables:{first:100,skip:skip},fetchPolicy:'cache-first'});case 7:result=_context.sent;if(result){newExchanges=newExchanges.concat(result.data.exchanges);skip=skip+100;if(skip===200){gettingExchanges=false;}}_context.next=4;break;case 11:setMaxPage(Math.floor(newExchanges.length/TXS_PER_PAGE));SetFilteredTxs(newExchanges);setExchanges(newExchanges);case 14:case\"end\":return _context.stop();}}},_callee);}));return _getTxs.apply(this,arguments);}getTxs();},[]);useEffect(function(){function get24HrVol(){var promises=[];var currentData={};exchanges.map(function(item){try{currentData[item.id]=item;var utcCurrentTime=dayjs();var utcOneDayBack=utcCurrentTime.subtract(1,'day');var result24HoursAgo;result24HoursAgo=client.query({query:TICKER_24HOUR_QUERY,variables:{exchangeAddr:item.id,timestamp:utcOneDayBack.unix()},fetchPolicy:'cache-first'});promises.push(result24HoursAgo);return true;}catch(err){console.log('error: ',err);return false;}});Promise.all(promises).then(function(resolved){var new24HourData={};resolved.map(function(oldItem){// get first result less than 24 hours ago\nvar data24HoursAgo=oldItem.data.exchangeHistoricalDatas[0];if(data24HoursAgo){var exchangeID=data24HoursAgo.exchangeAddress;new24HourData[exchangeID]={};//set the price data\nnew24HourData[exchangeID].price=currentData[exchangeID].price;new24HourData[exchangeID].priceUSD=currentData[exchangeID].priceUSD;// get the volume difference\nvar oneDayVolume=currentData[exchangeID].tradeVolumeEth-data24HoursAgo.tradeVolumeEth;new24HourData[exchangeID].volume=oneDayVolume;var oneDayVolumeUSD=currentData[exchangeID].tradeVolumeUSD-data24HoursAgo.tradeVolumeUSD;new24HourData[exchangeID].volumeUSD=oneDayVolumeUSD;// get the tx difference\nvar oneDayTxs=currentData[exchangeID].totalTxsCount-data24HoursAgo.totalTxsCount;new24HourData[exchangeID].txs=oneDayTxs;var priceChangeRaw=((currentData[exchangeID].priceUSD-data24HoursAgo.tokenPriceUSD)/currentData[exchangeID].priceUSD*100).toFixed(2);new24HourData[exchangeID].priceChange=priceChangeRaw;var priceChangeETH=((1/currentData[exchangeID].price-1/data24HoursAgo.price)/(1/currentData[exchangeID].price)*100).toFixed(2);new24HourData[exchangeID].priceChangeETH=priceChangeETH;}return true;});setLoading(false);setExchangeData24Hour(new24HourData);});}get24HrVol();},[exchanges]);var belowMedium=useMedia('(max-width: 64em)');var belowSmall=useMedia('(max-width: 40em)');var TransactionItem=function TransactionItem(_ref2){var exchange=_ref2.exchange,id=_ref2.id;if(exchange.tokenAddress==='0x89d24a6b4ccb1b6faa2625fe562bdd9a23260359'){exchange.tokenSymbol='SAI';}if(exchange.tokenAddress==='0xf5dce57282a584d2746faf1593d3121fcac444dc'){exchange.tokenSymbol='cSAI';exchange.tokenName='Compound SAI';}return React.createElement(DashGridClickable,{style:{height:'60px'}},React.createElement(Flex,{alignItems:\"center\",justifyContent:\"flex-start\"},React.createElement(\"div\",{style:{minWidth:'30px'}},id+(page-1)*TXS_PER_PAGE),React.createElement(LogoBox,null,React.createElement(TokenLogo,{size:24,address:exchange.tokenAddress,style:{height:'24px',width:'24px'}})),!belowSmall?React.createElement(CustomLink,{to:'/token/'+exchange.tokenAddress,onClick:function onClick(){window.scrollTo(0,0);}},React.createElement(Text,{color:\"button\",area:'name',fontWeight:\"500\"},exchange.tokenName)):React.createElement(CustomLink,{to:'/token/'+exchange.tokenAddress,onClick:function onClick(){window.scrollTo(0,0);}},React.createElement(DataText,{area:'symbol',color:\"button\"},exchange.tokenSymbol))),!belowMedium?React.createElement(React.Fragment,null,React.createElement(DataText,{area:'symbol'},exchange.tokenSymbol),React.createElement(DataText,{area:'price'},exchange.price&&exchange.priceUSD?currencyUnit==='USD'?'$'+formattedNum(exchange.priceUSD,true):formattedNum(1/exchange.price)+' ETH':'')):'',React.createElement(DataText,{area:'liquidity'},exchangeData24Hour.hasOwnProperty(exchange.id)?currencyUnit==='USD'?'$'+formattedNum(exchange.ethBalance*2*exchangeData24Hour[exchange.id].price*exchangeData24Hour[exchange.id].priceUSD,true):formattedNum(exchange.ethBalance*2)+' ETH':'-'),React.createElement(DataText,{area:'volume'},exchangeData24Hour.hasOwnProperty(exchange.id)?currencyUnit==='USD'?'$'+formattedNum(exchangeData24Hour[exchange.id].volumeUSD,true):formattedNum(exchangeData24Hour[exchange.id].volume)+' ETH':'-'),!belowSmall?React.createElement(DataText,{area:'txs'},exchangeData24Hour.hasOwnProperty(exchange.id)?currencyUnit==='USD'?getPercentChangeColor(exchangeData24Hour[exchange.id].priceChange):getPercentChangeColor(exchangeData24Hour[exchange.id].priceChangeETH):'-'):'');};return React.createElement(ListWrapper,null,React.createElement(DashGrid,{center:true,style:{height:'60px'}},React.createElement(Flex,{alignItems:\"center\"},React.createElement(Text,{color:\"text\",area:'name'},\"Exchanges\")),!belowMedium?React.createElement(React.Fragment,null,React.createElement(Flex,{alignItems:\"center\"},React.createElement(ClickableText,{area:'liquidity',color:\"textDim\",onClick:function onClick(e){setSortedColumn(SORT_FIELD.SYMBOL);setSortDirection(!sortDirection);sortTxs(SORT_FIELD.SYMBOL);}},React.createElement(Text,null,\"Symbol \",sortedColumn===SORT_FIELD.SYMBOL?!sortDirection?'↑':'↓':''))),React.createElement(Flex,{alignItems:\"center\"},React.createElement(ClickableText,{area:'price',color:\"textDim\",onClick:function onClick(e){setSortedColumn(SORT_FIELD.PRICE);setSortDirection(!sortDirection);sortTxs(SORT_FIELD.PRICE);}},\"Price \",sortedColumn===SORT_FIELD.PRICE?!sortDirection?'↑':'↓':''))):'',React.createElement(Flex,{alignItems:\"center\"},React.createElement(ClickableText,{area:'liquidity',color:\"textDim\",onClick:function onClick(e){setSortedColumn(SORT_FIELD.LIQUIDITY);setSortDirection(!sortDirection);sortTxs(SORT_FIELD.LIQUIDITY);}},\"Liquidity \",sortedColumn===SORT_FIELD.LIQUIDITY?!sortDirection?'↑':'↓':'')),React.createElement(Flex,{alignItems:\"center\"},React.createElement(ClickableText,{area:'liquidity',color:\"textDim\",onClick:function onClick(e){setSortedColumn(SORT_FIELD.VOLUME);setSortDirection(!sortDirection);sortTxs(SORT_FIELD.VOLUME);}},\"Volume (24hrs) \",sortedColumn===SORT_FIELD.VOLUME?sortDirection?'↑':'↓':'')),!belowSmall?React.createElement(Flex,{alignItems:\"center\"},React.createElement(ClickableText,{area:'liquidity',color:\"textDim\",onClick:function onClick(e){setSortedColumn(SORT_FIELD.PRICE_CHANGE);setSortDirection(!sortDirection);sortTxs(currencyUnit==='USD'?SORT_FIELD.PRICE_CHANGE:SORT_FIELD.PRICE_CHANGE_ETH);}},\"Price Change (24hrs) \",sortedColumn===SORT_FIELD.PRICE_CHANGE?sortDirection?'↑':'↓':'')):''),React.createElement(Divider,null),React.createElement(List,{p:0},loading||exchanges.length===0||exchangeData24Hour.length===0?React.createElement(Loader,null):filteredTxs.slice(TXS_PER_PAGE*(page-1),page*TXS_PER_PAGE).map(function(item,index){return React.createElement(\"div\",{key:index},React.createElement(TransactionItem,{key:index,exchange:item,id:index+1}),React.createElement(Divider,null));})),React.createElement(PageButtons,null,React.createElement(\"div\",{onClick:function onClick(e){setPage(page===1?page:page-1);}},React.createElement(Arrow,{faded:page===1?true:false},\"\\u2190\")),'Page '+page+' of '+maxPage,React.createElement(\"div\",{onClick:function onClick(e){setPage(page===maxPage?page:page+1);}},React.createElement(Arrow,{faded:page===maxPage?true:false},\"\\u2192\")),React.createElement(\"i\",{\"data-feather\":\"circle\"})));}OverviewList.defaultProps={transactions:[]};export default OverviewList;","map":{"version":3,"sources":["/workspace/uniswap-info/src/components/OverviewList/index.js"],"names":["React","useState","useEffect","Link","useMedia","dayjs","utc","client","OVERVIEW_PAGE_QUERY","TICKER_24HOUR_QUERY","Box","Flex","Text","styled","TokenLogo","formattedNum","Divider","Loader","extend","PageButtons","div","Arrow","props","faded","List","DashGrid","DashGridClickable","ListWrapper","ClickableText","DataText","LogoBox","CustomLink","OverviewList","currencyUnit","exchanges","setExchanges","filteredTxs","SetFilteredTxs","exchangeData24Hour","setExchangeData24Hour","page","setPage","maxPage","setMaxPage","TXS_PER_PAGE","loading","setLoading","sortDirection","setSortDirection","SORT_FIELD","PRICE","LIQUIDITY","TRANSACTIIONS","VOLUME","SYMBOL","PRICE_CHANGE","PRICE_CHANGE_ETH","sortedColumn","setSortedColumn","getPercentChangeColor","change","color","sortTxs","field","newTxs","slice","sort","a","b","hasOwnProperty","id","volume","txs","priceChange","priceChangeETH","parseFloat","toString","toLowerCase","getTxs","gettingExchanges","newExchanges","skip","query","variables","first","fetchPolicy","result","concat","data","Math","floor","length","get24HrVol","promises","currentData","map","item","utcCurrentTime","utcOneDayBack","subtract","result24HoursAgo","exchangeAddr","timestamp","unix","push","err","console","log","Promise","all","then","resolved","new24HourData","oldItem","data24HoursAgo","exchangeHistoricalDatas","exchangeID","exchangeAddress","price","priceUSD","oneDayVolume","tradeVolumeEth","oneDayVolumeUSD","tradeVolumeUSD","volumeUSD","oneDayTxs","totalTxsCount","priceChangeRaw","tokenPriceUSD","toFixed","belowMedium","belowSmall","TransactionItem","exchange","tokenAddress","tokenSymbol","tokenName","height","minWidth","width","window","scrollTo","ethBalance","e","index","defaultProps","transactions"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport { Link } from 'react-router-dom'\nimport { useMedia } from 'react-use'\nimport dayjs from 'dayjs'\nimport utc from 'dayjs/plugin/utc'\nimport { client } from '../../apollo/client'\nimport { OVERVIEW_PAGE_QUERY, TICKER_24HOUR_QUERY } from '../../apollo/queries'\nimport { Box, Flex, Text } from 'rebass'\nimport PropTypes from 'prop-types'\nimport styled from 'styled-components'\nimport TokenLogo from '../TokenLogo'\nimport { formattedNum } from '../../helpers'\nimport { Divider } from '../../components'\nimport Loader from '../../components/Loader'\n\ndayjs.extend(utc)\n\nconst PageButtons = styled.div`\n  width: 100%;\n  display: flex;\n  justify-content: center;\n  margin-top: 2em;\n  margin-bottom: 2em;\n`\n\nconst Arrow = styled.div`\n  color: #2f80ed;\n  opacity: ${props => (props.faded ? 0.3 : 1)};\n  padding: 0 20px;\n  user-select: none;\n\n  :hover {\n    cursor: pointer;\n  }\n`\n\nconst List = styled(Box)`\n  -webkit-overflow-scrolling: touch;\n`\n\nconst DashGrid = styled.div`\n  display: grid;\n  grid-gap: 1em;\n  grid-template-columns: 1fr 1fr 1fr;\n  grid-template-areas: 'symbol liquidity volume';\n  padding: 0 6px;\n\n  > * {\n    justify-content: flex-end;\n    width: 100%;\n\n    &:first-child {\n      justify-content: flex-start;\n      width: 100px;\n    }\n  }\n\n  @media screen and (min-width: 40em) {\n    max-width: 1280px;\n    display: grid;\n    grid-gap: 1em;\n    grid-template-columns: 0.8fr 1fr 1fr 1fr;\n    grid-template-areas: 'name txs liquidity volume';\n\n    > * {\n      justify-content: flex-end;\n      width: 100%;\n\n      &:first-child {\n        justify-content: flex-start;\n        width: 240px;\n      }\n    }\n  }\n\n  @media screen and (min-width: 64em) {\n    max-width: 1280px;\n    display: grid;\n    padding: 0 24px;\n    grid-gap: 1em;\n    grid-template-columns: 1fr 0.8fr 0.8fr 1fr 1fr 1fr;\n    grid-template-areas: 'name symbol price volume liquidity txs';\n  }\n`\n\nconst DashGridClickable = styled(DashGrid)`\n  :hover {\n    // background-color: #f8f8f8;\n    // cursor: pointer;\n  }\n`\n\nconst ListWrapper = styled.div`\n  @media screen and (max-width: 40em) {\n    padding: 0 0.4em;\n  }\n`\n\nconst ClickableText = styled(Text)`\n  text-align: right;\n\n  &:hover {\n    cursor: pointer;\n    opacity: 0.6;\n  }\n\n  user-select: none;\n`\n\nconst DataText = styled(Flex)`\n  @media screen and (max-width: 40em) {\n    font-size: 14px;\n  }\n\n  align-items: center;\n  text-align: right;\n\n  & > * {\n    font-size: 1em;\n  }\n`\n\nconst LogoBox = styled.div`\n  width: 30px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  margin-right: 4px;\n\n  @media screen and (max-width: 40em) {\n    margin-right: 6px;\n  }\n`\n\nconst CustomLink = styled(Link)`\n  text-decoration: none;\n\n  &:visited {\n    color: rgb(47, 128, 237);\n  }\n`\n\n// @TODO rework into virtualized list\nfunction OverviewList({ currencyUnit }) {\n  const [exchanges, setExchanges] = useState([])\n\n  const [filteredTxs, SetFilteredTxs] = useState([])\n\n  const [exchangeData24Hour, setExchangeData24Hour] = useState({})\n\n  const [page, setPage] = useState(1)\n\n  const [maxPage, setMaxPage] = useState(1)\n\n  const TXS_PER_PAGE = 10\n\n  const [loading, setLoading] = useState(true)\n\n  const [sortDirection, setSortDirection] = useState(true)\n\n  const SORT_FIELD = {\n    PRICE: 'priceUSD',\n    LIQUIDITY: 'ethBalance',\n    TRANSACTIIONS: 'txs',\n    VOLUME: 'volume',\n    SYMBOL: 'tokenSymbol',\n    PRICE_CHANGE: 'priceChange',\n    PRICE_CHANGE_ETH: 'priceChangeETH'\n  }\n\n  const [sortedColumn, setSortedColumn] = useState(SORT_FIELD.LIQUIDITY)\n\n  function getPercentChangeColor(change) {\n    if (change === 0) {\n      return <span>{change + ' %'}</span>\n    }\n    if (change < 0) {\n      return <span style={{ color: 'red' }}>{change + ' %'}</span>\n    }\n    return <span style={{ color: 'green' }}>{change + ' %'}</span>\n  }\n\n  function sortTxs(field) {\n    if (\n      field === SORT_FIELD.VOLUME ||\n      field === SORT_FIELD.TRANSACTIIONS ||\n      field === SORT_FIELD.PRICE_CHANGE ||\n      field === SORT_FIELD.PRICE_CHANGE_ETH\n    ) {\n      let newTxs = filteredTxs.slice().sort((a, b) => {\n        if (!exchangeData24Hour.hasOwnProperty(a.id)) {\n          exchangeData24Hour[a.id] = {}\n          exchangeData24Hour[a.id].volume = 0\n          exchangeData24Hour[a.id].txs = 0\n          exchangeData24Hour[a.id].priceChange = 0\n          exchangeData24Hour[a.id].priceChangeETH = 0\n          setExchangeData24Hour(exchangeData24Hour)\n        }\n        if (!exchangeData24Hour.hasOwnProperty(b.id)) {\n          exchangeData24Hour[b.id] = {}\n          exchangeData24Hour[b.id].volume = 0\n          exchangeData24Hour[a.id].txs = 0\n          exchangeData24Hour[b.id].priceChange = 0\n          exchangeData24Hour[a.id].priceChangeETH = 0\n          setExchangeData24Hour(exchangeData24Hour)\n        }\n        return parseFloat(exchangeData24Hour[a.id][field]) > parseFloat(exchangeData24Hour[b.id][field])\n          ? (sortDirection ? -1 : 1) * 1\n          : (sortDirection ? -1 : 1) * -1\n      })\n      SetFilteredTxs(newTxs)\n      setPage(1)\n    } else {\n      let newTxs\n      if (field === SORT_FIELD.SYMBOL) {\n        newTxs = filteredTxs.slice().sort((a, b) => {\n          return a[field].toString().toLowerCase() > b[field].toString().toLowerCase()\n            ? (sortDirection ? -1 : 1) * -1\n            : (sortDirection ? -1 : 1) * 1\n        })\n      } else {\n        newTxs = filteredTxs.slice().sort((a, b) => {\n          return parseFloat(a[field]) > parseFloat(b[field])\n            ? (sortDirection ? -1 : 1) * -1\n            : (sortDirection ? -1 : 1) * 1\n        })\n      }\n      SetFilteredTxs(newTxs)\n      setPage(1)\n    }\n  }\n\n  useEffect(() => {\n    setSortDirection(true)\n  }, [exchanges])\n\n  // get top 100 exchanges by liquidity\n  useEffect(() => {\n    setPage(1)\n\n    async function getTxs() {\n      setLoading(true)\n      let gettingExchanges = true\n      let newExchanges = []\n      let skip = 0\n      while (gettingExchanges) {\n        let result = await client.query({\n          query: OVERVIEW_PAGE_QUERY,\n          variables: {\n            first: 100,\n            skip: skip\n          },\n          fetchPolicy: 'cache-first'\n        })\n        if (result) {\n          newExchanges = newExchanges.concat(result.data.exchanges)\n          skip = skip + 100\n          if (skip === 200) {\n            gettingExchanges = false\n          }\n        }\n      }\n      setMaxPage(Math.floor(newExchanges.length / TXS_PER_PAGE))\n      SetFilteredTxs(newExchanges)\n      setExchanges(newExchanges)\n    }\n    getTxs()\n  }, [])\n\n  useEffect(() => {\n    function get24HrVol() {\n      let promises = []\n      let currentData = {}\n      exchanges.map(item => {\n        try {\n          currentData[item.id] = item\n          const utcCurrentTime = dayjs()\n          const utcOneDayBack = utcCurrentTime.subtract(1, 'day')\n          let result24HoursAgo\n          result24HoursAgo = client.query({\n            query: TICKER_24HOUR_QUERY,\n            variables: {\n              exchangeAddr: item.id,\n              timestamp: utcOneDayBack.unix()\n            },\n            fetchPolicy: 'cache-first'\n          })\n          promises.push(result24HoursAgo)\n\n          return true\n        } catch (err) {\n          console.log('error: ', err)\n          return false\n        }\n      })\n\n      Promise.all(promises).then(resolved => {\n        let new24HourData = {}\n        resolved.map(oldItem => {\n          // get first result less than 24 hours ago\n          let data24HoursAgo = oldItem.data.exchangeHistoricalDatas[0]\n\n          if (data24HoursAgo) {\n            const exchangeID = data24HoursAgo.exchangeAddress\n\n            new24HourData[exchangeID] = {}\n\n            //set the price data\n            new24HourData[exchangeID].price = currentData[exchangeID].price\n            new24HourData[exchangeID].priceUSD = currentData[exchangeID].priceUSD\n\n            // get the volume difference\n            let oneDayVolume = currentData[exchangeID].tradeVolumeEth - data24HoursAgo.tradeVolumeEth\n            new24HourData[exchangeID].volume = oneDayVolume\n\n            let oneDayVolumeUSD = currentData[exchangeID].tradeVolumeUSD - data24HoursAgo.tradeVolumeUSD\n            new24HourData[exchangeID].volumeUSD = oneDayVolumeUSD\n\n            // get the tx difference\n            let oneDayTxs = currentData[exchangeID].totalTxsCount - data24HoursAgo.totalTxsCount\n            new24HourData[exchangeID].txs = oneDayTxs\n\n            const priceChangeRaw = (\n              ((currentData[exchangeID].priceUSD - data24HoursAgo.tokenPriceUSD) / currentData[exchangeID].priceUSD) *\n              100\n            ).toFixed(2)\n            new24HourData[exchangeID].priceChange = priceChangeRaw\n\n            const priceChangeETH = (\n              ((1 / currentData[exchangeID].price - 1 / data24HoursAgo.price) / (1 / currentData[exchangeID].price)) *\n              100\n            ).toFixed(2)\n            new24HourData[exchangeID].priceChangeETH = priceChangeETH\n          }\n          return true\n        })\n        setLoading(false)\n        setExchangeData24Hour(new24HourData)\n      })\n    }\n    get24HrVol()\n  }, [exchanges])\n\n  const belowMedium = useMedia('(max-width: 64em)')\n\n  const belowSmall = useMedia('(max-width: 40em)')\n\n  const TransactionItem = ({ exchange, id }) => {\n    if (exchange.tokenAddress === '0x89d24a6b4ccb1b6faa2625fe562bdd9a23260359') {\n      exchange.tokenSymbol = 'SAI'\n    }\n    if (exchange.tokenAddress === '0xf5dce57282a584d2746faf1593d3121fcac444dc') {\n      exchange.tokenSymbol = 'cSAI'\n      exchange.tokenName = 'Compound SAI'\n    }\n    return (\n      <DashGridClickable style={{ height: '60px' }}>\n        <Flex alignItems=\"center\" justifyContent=\"flex-start\">\n          <div style={{ minWidth: '30px' }}>{id + (page - 1) * TXS_PER_PAGE}</div>\n          <LogoBox>\n            <TokenLogo size={24} address={exchange.tokenAddress} style={{ height: '24px', width: '24px' }} />\n          </LogoBox>\n          {!belowSmall ? (\n            <CustomLink\n              to={'/token/' + exchange.tokenAddress}\n              onClick={() => {\n                window.scrollTo(0, 0)\n              }}\n            >\n              <Text color=\"button\" area={'name'} fontWeight=\"500\">\n                {exchange.tokenName}\n              </Text>\n            </CustomLink>\n          ) : (\n            <CustomLink\n              to={'/token/' + exchange.tokenAddress}\n              onClick={() => {\n                window.scrollTo(0, 0)\n              }}\n            >\n              <DataText area={'symbol'} color=\"button\">\n                {exchange.tokenSymbol}\n              </DataText>\n            </CustomLink>\n          )}\n        </Flex>\n        {!belowMedium ? (\n          <>\n            <DataText area={'symbol'}>{exchange.tokenSymbol}</DataText>\n            <DataText area={'price'}>\n              {exchange.price && exchange.priceUSD\n                ? currencyUnit === 'USD'\n                  ? '$' + formattedNum(exchange.priceUSD, true)\n                  : formattedNum(1 / exchange.price) + ' ETH'\n                : ''}\n            </DataText>\n          </>\n        ) : (\n          ''\n        )}\n        <DataText area={'liquidity'}>\n          {exchangeData24Hour.hasOwnProperty(exchange.id)\n            ? currencyUnit === 'USD'\n              ? '$' +\n                formattedNum(\n                  exchange.ethBalance *\n                    2 *\n                    exchangeData24Hour[exchange.id].price *\n                    exchangeData24Hour[exchange.id].priceUSD,\n                  true\n                )\n              : formattedNum(exchange.ethBalance * 2) + ' ETH'\n            : '-'}\n        </DataText>\n\n        <DataText area={'volume'}>\n          {exchangeData24Hour.hasOwnProperty(exchange.id)\n            ? currencyUnit === 'USD'\n              ? '$' + formattedNum(exchangeData24Hour[exchange.id].volumeUSD, true)\n              : formattedNum(exchangeData24Hour[exchange.id].volume) + ' ETH'\n            : '-'}\n        </DataText>\n        {!belowSmall ? (\n          <DataText area={'txs'}>\n            {exchangeData24Hour.hasOwnProperty(exchange.id)\n              ? currencyUnit === 'USD'\n                ? getPercentChangeColor(exchangeData24Hour[exchange.id].priceChange)\n                : getPercentChangeColor(exchangeData24Hour[exchange.id].priceChangeETH)\n              : '-'}\n          </DataText>\n        ) : (\n          ''\n        )}\n      </DashGridClickable>\n    )\n  }\n\n  return (\n    <ListWrapper>\n      <DashGrid center={true} style={{ height: '60px' }}>\n        <Flex alignItems=\"center\">\n          <Text color=\"text\" area={'name'}>\n            Exchanges\n          </Text>\n        </Flex>\n        {!belowMedium ? (\n          <>\n            <Flex alignItems=\"center\">\n              <ClickableText\n                area={'liquidity'}\n                color=\"textDim\"\n                onClick={e => {\n                  setSortedColumn(SORT_FIELD.SYMBOL)\n                  setSortDirection(!sortDirection)\n                  sortTxs(SORT_FIELD.SYMBOL)\n                }}\n              >\n                <Text>Symbol {sortedColumn === SORT_FIELD.SYMBOL ? (!sortDirection ? '↑' : '↓') : ''}</Text>\n              </ClickableText>\n            </Flex>\n            <Flex alignItems=\"center\">\n              <ClickableText\n                area={'price'}\n                color=\"textDim\"\n                onClick={e => {\n                  setSortedColumn(SORT_FIELD.PRICE)\n                  setSortDirection(!sortDirection)\n                  sortTxs(SORT_FIELD.PRICE)\n                }}\n              >\n                Price {sortedColumn === SORT_FIELD.PRICE ? (!sortDirection ? '↑' : '↓') : ''}\n              </ClickableText>\n            </Flex>\n          </>\n        ) : (\n          ''\n        )}\n        <Flex alignItems=\"center\">\n          <ClickableText\n            area={'liquidity'}\n            color=\"textDim\"\n            onClick={e => {\n              setSortedColumn(SORT_FIELD.LIQUIDITY)\n              setSortDirection(!sortDirection)\n              sortTxs(SORT_FIELD.LIQUIDITY)\n            }}\n          >\n            Liquidity {sortedColumn === SORT_FIELD.LIQUIDITY ? (!sortDirection ? '↑' : '↓') : ''}\n          </ClickableText>\n        </Flex>\n        <Flex alignItems=\"center\">\n          <ClickableText\n            area={'liquidity'}\n            color=\"textDim\"\n            onClick={e => {\n              setSortedColumn(SORT_FIELD.VOLUME)\n              setSortDirection(!sortDirection)\n              sortTxs(SORT_FIELD.VOLUME)\n            }}\n          >\n            Volume (24hrs) {sortedColumn === SORT_FIELD.VOLUME ? (sortDirection ? '↑' : '↓') : ''}\n          </ClickableText>\n        </Flex>\n        {!belowSmall ? (\n          <Flex alignItems=\"center\">\n            <ClickableText\n              area={'liquidity'}\n              color=\"textDim\"\n              onClick={e => {\n                setSortedColumn(SORT_FIELD.PRICE_CHANGE)\n                setSortDirection(!sortDirection)\n                sortTxs(currencyUnit === 'USD' ? SORT_FIELD.PRICE_CHANGE : SORT_FIELD.PRICE_CHANGE_ETH)\n              }}\n            >\n              Price Change (24hrs) {sortedColumn === SORT_FIELD.PRICE_CHANGE ? (sortDirection ? '↑' : '↓') : ''}\n            </ClickableText>\n          </Flex>\n        ) : (\n          ''\n        )}\n      </DashGrid>\n\n      <Divider />\n      <List p={0}>\n        {loading || exchanges.length === 0 || exchangeData24Hour.length === 0 ? (\n          <Loader />\n        ) : (\n          filteredTxs.slice(TXS_PER_PAGE * (page - 1), page * TXS_PER_PAGE).map((item, index) => {\n            return (\n              <div key={index}>\n                <TransactionItem key={index} exchange={item} id={index + 1} />\n                <Divider />\n              </div>\n            )\n          })\n        )}\n      </List>\n      <PageButtons>\n        <div\n          onClick={e => {\n            setPage(page === 1 ? page : page - 1)\n          }}\n        >\n          <Arrow faded={page === 1 ? true : false}>←</Arrow>\n        </div>\n        {'Page ' + page + ' of ' + maxPage}\n        <div\n          onClick={e => {\n            setPage(page === maxPage ? page : page + 1)\n          }}\n        >\n          <Arrow faded={page === maxPage ? true : false}>→</Arrow>\n        </div>\n        <i data-feather=\"circle\"></i>\n      </PageButtons>\n    </ListWrapper>\n  )\n}\n\nOverviewList.defaultProps = {\n  transactions: []\n}\n\nOverviewList.propTypes = {\n  transactions: PropTypes.array.isRequired\n}\n\nexport default OverviewList\n"]},"metadata":{},"sourceType":"module"}