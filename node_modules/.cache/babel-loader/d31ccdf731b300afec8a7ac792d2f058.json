{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nlet counter = 0;\nconst buckets = {};\n\nexports.setHarmonicInterval = (fn, ms) => {\n  const id = counter++;\n\n  if (buckets[ms]) {\n    buckets[ms].listeners[id] = fn;\n  } else {\n    const timer = setInterval(() => {\n      const listeners = buckets[ms].listeners;\n      let didThrow = false;\n      let lastError;\n\n      for (const listener of Object.values(listeners)) {\n        try {\n          listener();\n        } catch (error) {\n          didThrow = true;\n          lastError = error;\n        }\n      }\n\n      if (didThrow) throw lastError;\n    }, ms);\n    buckets[ms] = {\n      ms,\n      timer,\n      listeners: {\n        [id]: fn\n      }\n    };\n  }\n\n  return {\n    bucket: buckets[ms],\n    id\n  };\n};\n\nexports.clearHarmonicInterval = ({\n  bucket,\n  id\n}) => {\n  delete bucket.listeners[id];\n  let hasListeners = false;\n\n  for (const listener in bucket.listeners) {\n    hasListeners = true;\n    break;\n  }\n\n  if (!hasListeners) {\n    clearInterval(bucket.timer);\n    delete buckets[bucket.ms];\n  }\n};","map":null,"metadata":{},"sourceType":"script"}