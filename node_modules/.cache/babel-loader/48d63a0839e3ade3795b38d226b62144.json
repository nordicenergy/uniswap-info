{"ast":null,"code":"import _regeneratorRuntime from\"/workspace/uniswap-info/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/workspace/uniswap-info/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{BigNumber}from'bignumber.js';import dayjs from'dayjs';import{client}from'../apollo/client';import{ExportToCsv}from'export-to-csv';import{ethers}from'ethers';import utc from'dayjs/plugin/utc';import{TRANSACTIONS_QUERY_SKIPPABLE}from'../apollo/queries';BigNumber.set({EXPONENTIAL_AT:50});dayjs.extend(utc);export var toNiceDate=function toNiceDate(date){// let df = new Date(date * 1000).toUTCString('MMMM DD')\nvar x=dayjs.utc(dayjs.unix(date)).format('MMM DD');return x;};export var toNiceDateYear=function toNiceDateYear(date){return dayjs.utc(dayjs.unix(date)).format('MMMM DD, YYYY');};export var isAddress=function isAddress(value){try{return ethers.utils.getAddress(value.toLowerCase());}catch(_unused){return false;}};export var isWeb3Available=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(typeof window.ethereum!=='undefined')){_context.next=13;break;}window.web3=new Web3(ethereum);_context.prev=2;_context.next=5;return ethereum.enable();case 5:return _context.abrupt(\"return\",true);case 8:_context.prev=8;_context.t0=_context[\"catch\"](2);return _context.abrupt(\"return\",false);case 11:_context.next=19;break;case 13:if(!(typeof window.web3!=='undefined')){_context.next=18;break;}window.web3=new Web3(web3.currentProvider);return _context.abrupt(\"return\",true);case 18:return _context.abrupt(\"return\",false);case 19:case\"end\":return _context.stop();}}},_callee,null,[[2,8]]);}));return function isWeb3Available(){return _ref.apply(this,arguments);};}();export var toK=function toK(num,fixed){var formatter=function formatter(divideBy){return fixed===true?Number(num/divideBy).toFixed(4):Number(num/divideBy);};if(num>999999||num<-999999){return\"\".concat(formatter(1000000),\"M\");}else if(num>999||num<-999){return\"\".concat(formatter(1000),\"K\");}else{return formatter(1);}};export var setThemeColor=function setThemeColor(theme){return document.documentElement.style.setProperty('--c-token',theme||'#333333');};export var Big=function Big(number){return new BigNumber(number);};export var urls={showTransaction:function showTransaction(tx){return\"https://etherscan.io/tx/\".concat(tx,\"/\");},showAddress:function showAddress(address){return\"https://www.etherscan.io/address/\".concat(address,\"/\");},showToken:function showToken(address){return\"https://www.etherscan.io/token/\".concat(address,\"/\");},showBlock:function showBlock(block){return\"https://etherscan.io/block/\".concat(block,\"/\");}};export var formatTime=function formatTime(unix){var now=dayjs();var timestamp=dayjs.unix(unix);var inSeconds=now.diff(timestamp,'second');var inMinutes=now.diff(timestamp,'minute');var inHours=now.diff(timestamp,'hour');var inDays=now.diff(timestamp,'day');if(inHours>=24){return\"\".concat(inDays,\" \").concat(inDays===1?'day':'days',\" ago\");}else if(inMinutes>=60){return\"\".concat(inHours,\" \").concat(inHours===1?'hour':'hours',\" ago\");}else if(inSeconds>=60){return\"\".concat(inMinutes,\" \").concat(inMinutes===1?'minute':'minutes',\" ago\");}else{return\"\".concat(inSeconds,\" \").concat(inSeconds===1?'second':'seconds',\" ago\");}};export var formatNumber=function formatNumber(num){return num.toString().replace(/(\\d)(?=(\\d{3})+(?!\\d))/g,'$1,');};export var getAllTransactions=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(address){var utcEndTime,utcStartTime,startTime,data,skipCount,fetchingData,result,options,csvdata,csvExporter;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:// current time\nutcEndTime=dayjs.utc();utcStartTime=utcEndTime.subtract(1,'year').startOf('day');startTime=utcStartTime.unix()-1;// -1 because we filter on greater than in the query\ndata=[];skipCount=0;fetchingData=true;case 6:if(!fetchingData){_context2.next=13;break;}_context2.next=9;return client.query({query:TRANSACTIONS_QUERY_SKIPPABLE,variables:{exchangeAddr:address,skip:skipCount},fetchPolicy:'network-only'});case 9:result=_context2.sent;if(result){skipCount=skipCount+100;if(result.data.transactions.length===0){fetchingData=false;}else if(result.data.transactions[result.data.transactions.length-1].timestamp<startTime){fetchingData=false;}data=data.concat(result.data.transactions);}_context2.next=6;break;case 13:options={fieldSeparator:',',quoteStrings:'\"',decimalSeparator:'.',showLabels:true,showTitle:true,title:'My Awesome CSV',useTextFile:false,useBom:true,useKeysAsHeaders:true// headers: ['Column 1', 'Column 2', etc...] <-- Won't work with useKeysAsHeaders present!\n};csvdata=[];Object.keys(data).map(function(index){return csvdata.push(data[index]);});csvExporter=new ExportToCsv(options);csvExporter.generateCsv(data);case 18:case\"end\":return _context2.stop();}}},_callee2);}));return function getAllTransactions(_x){return _ref2.apply(this,arguments);};}();// using a currency library here in case we want to add more in future\nvar priceFormatter=new Intl.NumberFormat('en-US',{style:'currency',currency:'USD'});export var formattedNum=function formattedNum(number){var usd=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(isNaN(number)||number===''){return'';}var num=parseFloat(number);if(num===0){return 0;}if(num<0.0001){return'< 0.0001';}if(num>1000){return Number(parseFloat(num).toFixed(0)).toLocaleString();}if(usd){if(num<0.01){return Number(parseFloat(num).toFixed(4));}var usdString=priceFormatter.format(num);return usdString.slice(1,usdString.length);}return Number(parseFloat(num).toFixed(4));};export var get2DayPercentFormatted=function get2DayPercentFormatted(valueNow,value24HoursAgo,value48HoursAgo){// get volume info for both 24 hour periods\nvar firstDayValue=value24HoursAgo-value48HoursAgo;var secondDayValue=valueNow-value24HoursAgo;var amountChange=secondDayValue-firstDayValue;var percentChange='';var adjustedPercentChange=(amountChange/firstDayValue*100).toFixed(2);adjustedPercentChange>0?percentChange='+':percentChange='';percentChange+=adjustedPercentChange;if(isNaN(percentChange)||!isFinite(percentChange)){return[secondDayValue,0];}return[secondDayValue,percentChange];};export var getPercentFormatted=function getPercentFormatted(valueNow,value24HoursAgo){var percentChange='';var adjustedPercentChange=((valueNow-value24HoursAgo)/value24HoursAgo*100).toFixed(2);adjustedPercentChange>0?percentChange='+':percentChange='';percentChange+=adjustedPercentChange;if(isNaN(percentChange)){return 0;}return percentChange;};","map":{"version":3,"sources":["/workspace/uniswap-info/src/helpers/index.js"],"names":["BigNumber","dayjs","client","ExportToCsv","ethers","utc","TRANSACTIONS_QUERY_SKIPPABLE","set","EXPONENTIAL_AT","extend","toNiceDate","date","x","unix","format","toNiceDateYear","isAddress","value","utils","getAddress","toLowerCase","isWeb3Available","window","ethereum","web3","Web3","enable","currentProvider","toK","num","fixed","formatter","divideBy","Number","toFixed","setThemeColor","theme","document","documentElement","style","setProperty","Big","number","urls","showTransaction","tx","showAddress","address","showToken","showBlock","block","formatTime","now","timestamp","inSeconds","diff","inMinutes","inHours","inDays","formatNumber","toString","replace","getAllTransactions","utcEndTime","utcStartTime","subtract","startOf","startTime","data","skipCount","fetchingData","query","variables","exchangeAddr","skip","fetchPolicy","result","transactions","length","concat","options","fieldSeparator","quoteStrings","decimalSeparator","showLabels","showTitle","title","useTextFile","useBom","useKeysAsHeaders","csvdata","Object","keys","map","index","push","csvExporter","generateCsv","priceFormatter","Intl","NumberFormat","currency","formattedNum","usd","isNaN","parseFloat","toLocaleString","usdString","slice","get2DayPercentFormatted","valueNow","value24HoursAgo","value48HoursAgo","firstDayValue","secondDayValue","amountChange","percentChange","adjustedPercentChange","isFinite","getPercentFormatted"],"mappings":"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","sourcesContent":["import { BigNumber } from 'bignumber.js'\nimport dayjs from 'dayjs'\nimport { client } from '../apollo/client'\nimport { ExportToCsv } from 'export-to-csv'\nimport { ethers } from 'ethers'\nimport utc from 'dayjs/plugin/utc'\n\nimport { TRANSACTIONS_QUERY_SKIPPABLE } from '../apollo/queries'\n\nBigNumber.set({ EXPONENTIAL_AT: 50 })\n\ndayjs.extend(utc)\n\nexport const toNiceDate = date => {\n  // let df = new Date(date * 1000).toUTCString('MMMM DD')\n  let x = dayjs.utc(dayjs.unix(date)).format('MMM DD')\n  return x\n}\n\nexport const toNiceDateYear = date => dayjs.utc(dayjs.unix(date)).format('MMMM DD, YYYY')\n\nexport const isAddress = value => {\n  try {\n    return ethers.utils.getAddress(value.toLowerCase())\n  } catch {\n    return false\n  }\n}\n\nexport const isWeb3Available = async () => {\n  /* eslint-disable */\n  if (typeof window.ethereum !== 'undefined') {\n    window.web3 = new Web3(ethereum)\n    try {\n      await ethereum.enable()\n      return true\n    } catch (error) {\n      return false\n    }\n  } else if (typeof window.web3 !== 'undefined') {\n    window.web3 = new Web3(web3.currentProvider)\n    return true\n  } else {\n    return false\n  }\n  /* eslint-enable */\n}\n\nexport const toK = (num, fixed) => {\n  const formatter = divideBy => (fixed === true ? Number(num / divideBy).toFixed(4) : Number(num / divideBy))\n\n  if (num > 999999 || num < -999999) {\n    return `${formatter(1000000)}M`\n  } else if (num > 999 || num < -999) {\n    return `${formatter(1000)}K`\n  } else {\n    return formatter(1)\n  }\n}\n\nexport const setThemeColor = theme => document.documentElement.style.setProperty('--c-token', theme || '#333333')\n\nexport const Big = number => new BigNumber(number)\n\nexport const urls = {\n  showTransaction: tx => `https://etherscan.io/tx/${tx}/`,\n  showAddress: address => `https://www.etherscan.io/address/${address}/`,\n  showToken: address => `https://www.etherscan.io/token/${address}/`,\n  showBlock: block => `https://etherscan.io/block/${block}/`\n}\n\nexport const formatTime = unix => {\n  const now = dayjs()\n  const timestamp = dayjs.unix(unix)\n\n  const inSeconds = now.diff(timestamp, 'second')\n  const inMinutes = now.diff(timestamp, 'minute')\n  const inHours = now.diff(timestamp, 'hour')\n  const inDays = now.diff(timestamp, 'day')\n\n  if (inHours >= 24) {\n    return `${inDays} ${inDays === 1 ? 'day' : 'days'} ago`\n  } else if (inMinutes >= 60) {\n    return `${inHours} ${inHours === 1 ? 'hour' : 'hours'} ago`\n  } else if (inSeconds >= 60) {\n    return `${inMinutes} ${inMinutes === 1 ? 'minute' : 'minutes'} ago`\n  } else {\n    return `${inSeconds} ${inSeconds === 1 ? 'second' : 'seconds'} ago`\n  }\n}\n\nexport const formatNumber = num => {\n  return num.toString().replace(/(\\d)(?=(\\d{3})+(?!\\d))/g, '$1,')\n}\n\nexport const getAllTransactions = async address => {\n  // current time\n  const utcEndTime = dayjs.utc()\n  let utcStartTime\n  utcStartTime = utcEndTime.subtract(1, 'year').startOf('day')\n  let startTime = utcStartTime.unix() - 1 // -1 because we filter on greater than in the query\n  let data = []\n  let skipCount = 0\n  let fetchingData = true\n\n  while (fetchingData) {\n    let result = await client.query({\n      query: TRANSACTIONS_QUERY_SKIPPABLE,\n      variables: {\n        exchangeAddr: address,\n        skip: skipCount\n      },\n      fetchPolicy: 'network-only'\n    })\n    if (result) {\n      skipCount = skipCount + 100\n      if (result.data.transactions.length === 0) {\n        fetchingData = false\n      } else if (result.data.transactions[result.data.transactions.length - 1].timestamp < startTime) {\n        fetchingData = false\n      }\n      data = data.concat(result.data.transactions)\n    }\n  }\n\n  const options = {\n    fieldSeparator: ',',\n    quoteStrings: '\"',\n    decimalSeparator: '.',\n    showLabels: true,\n    showTitle: true,\n    title: 'My Awesome CSV',\n    useTextFile: false,\n    useBom: true,\n    useKeysAsHeaders: true\n    // headers: ['Column 1', 'Column 2', etc...] <-- Won't work with useKeysAsHeaders present!\n  }\n  let csvdata = []\n  Object.keys(data).map(index => {\n    return csvdata.push(data[index])\n  })\n  const csvExporter = new ExportToCsv(options)\n  csvExporter.generateCsv(data)\n}\n\n// using a currency library here in case we want to add more in future\nvar priceFormatter = new Intl.NumberFormat('en-US', {\n  style: 'currency',\n  currency: 'USD'\n})\n\nexport const formattedNum = (number, usd = false) => {\n  if (isNaN(number) || number === '') {\n    return ''\n  }\n  let num = parseFloat(number)\n  if (num === 0) {\n    return 0\n  }\n  if (num < 0.0001) {\n    return '< 0.0001'\n  }\n\n  if (num > 1000) {\n    return Number(parseFloat(num).toFixed(0)).toLocaleString()\n  }\n\n  if (usd) {\n    if (num < 0.01) {\n      return Number(parseFloat(num).toFixed(4))\n    }\n    let usdString = priceFormatter.format(num)\n    return usdString.slice(1, usdString.length)\n  }\n  return Number(parseFloat(num).toFixed(4))\n}\n\nexport const get2DayPercentFormatted = (valueNow, value24HoursAgo, value48HoursAgo) => {\n  // get volume info for both 24 hour periods\n  let firstDayValue = value24HoursAgo - value48HoursAgo\n  let secondDayValue = valueNow - value24HoursAgo\n  let amountChange = secondDayValue - firstDayValue\n\n  let percentChange = ''\n  const adjustedPercentChange = ((amountChange / firstDayValue) * 100).toFixed(2)\n  adjustedPercentChange > 0 ? (percentChange = '+') : (percentChange = '')\n  percentChange += adjustedPercentChange\n\n  if (isNaN(percentChange) || !isFinite(percentChange)) {\n    return [secondDayValue, 0]\n  }\n\n  return [secondDayValue, percentChange]\n}\n\nexport const getPercentFormatted = (valueNow, value24HoursAgo) => {\n  let percentChange = ''\n  const adjustedPercentChange = (((valueNow - value24HoursAgo) / value24HoursAgo) * 100).toFixed(2)\n  adjustedPercentChange > 0 ? (percentChange = '+') : (percentChange = '')\n  percentChange += adjustedPercentChange\n\n  if (isNaN(percentChange)) {\n    return 0\n  }\n\n  return percentChange\n}\n"]},"metadata":{},"sourceType":"module"}